{"version":3,"file":"../sticky-states.min.js","sources":["sticky-states.js"],"sourcesContent":["/**\n * File sticky-states.js.\n *\n * Implement sticky elements based on scroll position.\n */\n\n (function (root, factory) {\n\tif ( typeof define === 'function' && define.amd ) {\n\t  define([], factory(root));\n\t} else if ( typeof exports === 'object' ) {\n\t  module.exports = factory(root);\n\t} else {\n\t  root.StickyStates = factory(root);\n\t}\n})(typeof global !== 'undefined' ? global : this.window || this.global, function (root) {\n\n\t'use strict';\n\n\tvar _hasInitialized = false;\n\tvar _publicMethods = {\n\t\tmanagers: [],\n\t};\n\tvar _settings = {};\n\tvar _defaults = {\n\t\telementSelector: '[data-sticky-states]',\n\t\tinnerElementSelector: '[data-sticky-states-inner]',\n\n\t\tisEndPositionClass: 'is-end-position',\n\t\tisStickyClass: 'is-sticky',\n\t\tisStickyTopClass: 'is-sticky--top',\n\t\tisStickyBottomClass: 'is-sticky--bottom',\n\t\tisActivatedClass: 'is-activated',\n\n\t\tpositionAttribute: 'data-sticky-position',\n\t\tthresholdAttribute: 'data-sticky-threshold',\n\t\tstickyRelativeToAttribute: 'data-sticky-relative-to',\n\t\tstaticAtEndAttribute: 'data-sticky-static-at-end',\n\t\tcontainerAttribute: 'data-sticky-container',\n\n\t\tposition: 'top', // Accepted values: `top`, `bottom`\n\t\tthreshold: 0,\n\n\t\trefreshRate: 50,\n\t};\n\tvar _resizeObserver;\n\n\n\n\t/*!\n\t* Merge two or more objects together.\n\t* (c) 2017 Chris Ferdinandi, MIT License, https://gomakethings.com\n\t* @param   {Boolean}  deep     If true, do a deep (or recursive) merge [optional]\n\t* @param   {Object}   objects  The objects to merge together\n\t* @returns {Object}            Merged values of defaults and options\n\t*/\n\tvar extend = function () {\n\t\t// Variables\n\t\tvar extended = {};\n\t\tvar deep = false;\n\t\tvar i = 0;\n\n\t\t// Check if a deep merge\n\t\tif ( Object.prototype.toString.call( arguments[0] ) === '[object Boolean]' ) {\n\t\t\tdeep = arguments[0];\n\t\t\ti++;\n\t\t}\n\n\t\t// Merge the object into the extended object\n\t\tvar merge = function (obj) {\n\t\t\tfor (var prop in obj) {\n\t\t\t\tif (obj.hasOwnProperty(prop)) {\n\t\t\t\t\t// If property is an object, merge properties\n\t\t\t\t\tif (deep && Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n\t\t\t\t\t\textended[prop] = extend(extended[prop], obj[prop]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\textended[prop] = obj[prop];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t// Loop through each object and conduct a merge\n\t\tfor (; i < arguments.length; i++) {\n\t\t\tvar obj = arguments[i];\n\t\t\tmerge(obj);\n\t\t}\n\n\t\treturn extended;\n\t};\n\n\n\n\t/**\n\t * Execute a function immediately and prevent execution of the same method again for the amount of time defined as the threshold.\n\t *\n\t * @param   function  fn          Function to be executed.\n\t * @param   int       threshhold  Threshold time in milliseconds. Default 250ms.\n\t * @param   object    scope       Scope of execution of the function.\n\t *\n\t * @return  function              Function to be executed, incapsulated in a timed function.\n\t */\n\tvar _throttle = function( fn, threshhold, scope ) {\n\t\tthreshhold || (threshhold = 250);\n\n\t\tvar last,\n\t\t\tdeferTimer;\n\n\t\treturn function () {\n\t\t\tvar context = scope || this;\n\n\t\t\tvar now = +new Date,\n\t\t\t\targs = arguments;\n\n\t\t\tif ( last && now < last + threshhold ) {\n\t\t\t\t// hold on to it\n\t\t\t\tclearTimeout( deferTimer );\n\t\t\t\tdeferTimer = setTimeout( function () {\n\t\t\t\t\tlast = now;\n\t\t\t\t\tfn.apply( context, args );\n\t\t\t\t}, threshhold );\n\t\t\t}\n\t\t\telse {\n\t\t\t\tlast = now;\n\t\t\t\tfn.apply( context, args );\n\t\t\t}\n\t\t};\n\t}\n\n\n\n\t/**\n\t * Returns a function, that, as long as it continues to be invoked, will not\n\t * be triggered. The function will be called after it stops being called for\n\t * N milliseconds. If `immediate` is passed, trigger the function on the\n\t * leading edge, instead of the trailing.\n\t *\n\t * @param   {[type]}  func       Function to be executed.\n\t * @param   {[type]}  wait       Wait time in milliseconds.\n\t * @param   {[type]}  immediate  Trigger the function on the leading edge.\n\t *\n\t * @return  function              Function to be executed, incapsulated in a timed function.\n\t */\n\tvar _debounce = function ( func, wait, immediate ) {\n\t\tvar timeout;\n\n\t\treturn function() {\n\t\t  var context = this, args = arguments;\n\t\t  var later = function() {\n\t\t\ttimeout = null;\n\t\t\tif (!immediate) func.apply( context, args );\n\t\t  };\n\n\t\t  var callNow = immediate && !timeout;\n\t\t  clearTimeout( timeout );\n\t\t  timeout = setTimeout( later, wait );\n\n\t\t  if ( callNow ) func.apply( context, args );\n\t\t};\n\t};\n\n\n\n\t/**\n\t * Check if a string is a JSON object.\n\t */\n\tvar _isJSON = function( string ) {\n\t\ttry { JSON.parse( string ); }\n\t\tcatch ( e ) { return false; }\n\t\treturn true;\n\t}\n\n\n\n\t/**\n\t * Get the offset position of the element recursively adding the offset position of parent offset elements until the `stopElement` (or the `body` element).\n\t *\n\t * @param   HTMLElement  element      Element to get the offset position for.\n\t * @param   HTMLElement  stopElement  Parent offset element where to stop adding the offset position to the total offset top position of the element.\n\t *\n\t * @return  int                       Offset position of the element until the `stopElement` or the `body` element.\n\t */\n\tvar getOffsetTop = function( element, stopElement ) {\n\t\tvar offsetTop = 0;\n\n\t\twhile( element ) {\n\t\t\t// Reached the stopElement\n\t\t\tif ( stopElement && stopElement == element ) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\toffsetTop += element.offsetTop;\n\t\t\telement = element.offsetParent;\n\t\t}\n\n\t\treturn offsetTop;\n\t}\n\n\n\n\t/**\n\t * Check if the element is considered visible. Does not consider the CSS property `visibility: hidden;`.\n\t */\n\tvar isVisible = function( element ) {\n\t\treturn !!( element.offsetWidth || element.offsetHeight || element.getClientRects().length );\n\t}\n\n\n\n\t/**\n\t * Check if the element is considered sticky.\n\t */\n\t _publicMethods.isStickyPosition = function( element ) {\n\t\t// Try checking for the sticky class\n\t\tif ( element.matches( '.' + _settings.isStickyClass ) ) { return true; }\n\n\t\t// Try checking for computed styles (slower)\n\t\t// Used for elements set to sticky position by other means other than using sticky-states\n\t\tvar elementComputedPosition = window.getComputedStyle( element ).position;\n\t\treturn elementComputedPosition == 'fixed' || elementComputedPosition == 'sticky';\n\t}\n\n\n\n\t/**\n\t * Get the relative element to which the sticky element position will be calculated.\n\t *\n\t * @param   {string}  selectorOrJson  A string with a single CSS selector for the relative sticky element, or multiple selectors for various breakpoints as a JSON object.\n\t *\n\t * @return  {HTMLElement}             The relative sticky element, or `null` if not found.\n\t */\n\tvar getRelativeElement = function( selectorOrJson ) {\n\t\tvar relativeElement = null;\n\t\tvar windowWidth = window.innerWidth;\n\n\t\t// Multiple selectors for various breakpoints\n\t\tif ( _isJSON( selectorOrJson ) ) {\n\t\t\tvar breakpointSelectors = Object.entries( JSON.parse( selectorOrJson ) );\n\n\t\t\tfor ( var i = 0; i < breakpointSelectors.length; i++) {\n\t\t\t\tvar values = breakpointSelectors[ i ][ 1 ];\n\t\t\t\tif ( windowWidth >= values.breakpointInitial && windowWidth <= values.breakpointFinal ) {\n\t\t\t\t\trelativeElement = document.querySelector( values.selector );\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// Single selector\n\t\telse {\n\t\t\trelativeElement = document.querySelector( selectorOrJson );\n\t\t}\n\n\t\treturn relativeElement;\n\t}\n\n\n\n\t/**\n\t * Maybe change state of sticky elements.\n\t */\n\tvar maybeChangeState = function() {\n\t\tvar currentScrollPosition = window.pageYOffset || document.body.scrollTop;\n\n\t\t// Iterate sticky elements\n\t\tfor ( var i = 0; i < _publicMethods.managers.length; i++ ) {\n\t\t\tvar manager = _publicMethods.managers[ i ];\n\t\t\tvar containerStyles = window.getComputedStyle( manager.containerElement );\n\t\t\tvar stickyStyles = window.getComputedStyle( manager.stickyElement );\n\t\t\tvar containerHeight = parseInt( containerStyles.height.replace( 'px' ) );\n\t\t\tvar stickyHeight = parseInt( stickyStyles.height.replace( 'px' ) );\n\t\t\tvar isStickyShorterThanContainer = stickyHeight < containerHeight;\n\t\t\tvar isSticky = currentScrollPosition >= manager.settings.threshold;\n\t\t\tvar relativeHeight = 0;\n\t\t\tvar isEndThreshold = currentScrollPosition >= manager.settings.endThreshold;\n\t\t\tvar isStaticAtEnd = manager.stickyElement.hasAttribute( manager.settings.staticAtEndAttribute );\n\n\t\t\t// Maybe set isSticky value based on the relative element\n\t\t\tif ( manager.relativeElement && isVisible( manager.relativeElement ) && _publicMethods.isStickyPosition( manager.relativeElement ) ) {\n \t\t\t\trelativeHeight = manager.relativeElement.getBoundingClientRect().height;\n\t\t\t\tisSticky = currentScrollPosition >= ( manager.settings.threshold - relativeHeight );\n\t\t\t\tisEndThreshold = currentScrollPosition >= ( manager.settings.endThreshold - relativeHeight );\n\t\t\t}\n\n\t\t\t// Sticky\n\t\t\tif ( isSticky && isStickyShorterThanContainer && ! isEndThreshold ) {\n\t\t\t\tvar stickyInnerWidth = window.getComputedStyle( manager.innerElement ).width;\n\t\t\t\tmanager.innerElement.style.top = relativeHeight > 0 ? relativeHeight + 'px' : '';\n\t\t\t\tmanager.innerElement.style.width = stickyInnerWidth; // variable already has unit `px`\n\t\t\t\tmanager.stickyElement.style.height = stickyHeight + 'px';\n\t\t\t\tmanager.stickyElement.style.position = '';\n\t\t\t\tmanager.stickyElement.classList.add( manager.settings.isStickyClass, ( manager.settings.position == 'top' ? manager.settings.isStickyTopClass : manager.settings.isStickyBottomClass ) );\n\t\t\t\tmanager.stickyElement.classList.remove( manager.settings.isEndPositionClass );\n\t\t\t}\n\t\t\t// Absolute ( at end position )\n\t\t\telse if ( isEndThreshold && isStickyShorterThanContainer && ! isStaticAtEnd ) {\n\t\t\t\tvar elementOffsetToContainer = getOffsetTop( manager.stickyElement ) - getOffsetTop( manager.containerElement );\n\t\t\t\tmanager.innerElement.style.top = ( containerHeight - stickyHeight - elementOffsetToContainer ) + 'px';\n\t\t\t\tmanager.stickyElement.style.height = stickyHeight + 'px';\n\t\t\t\tmanager.stickyElement.classList.remove( manager.settings.isStickyClass, manager.settings.isStickyTopClass, manager.settings.isStickyBottomClass );\n\t\t\t\tmanager.stickyElement.classList.add( manager.settings.isEndPositionClass );\n\t\t\t}\n\t\t\t// Static\n\t\t\telse {\n\t\t\t\tmanager.stickyElement.classList.remove( manager.settings.isStickyClass, manager.settings.isStickyTopClass, manager.settings.isStickyBottomClass, manager.settings.isEndPositionClass );\n\t\t\t\tmanager.stickyElement.style.height = '';\n\t\t\t\tmanager.innerElement.style.width = '';\n\t\t\t\tmanager.innerElement.style.top = '';\n\t\t\t}\n\t\t}\n\t};\n\n\n\n\t/**\n\t * Loop function to changes visibility of the variation switcher.\n\t */\n\tvar throttledChangeState;\n\tvar loop = function() {\n\t\tthrottledChangeState();\n\t\t// Loop this function indefinitely\n\t\twindow.requestAnimationFrame( loop );\n\t};\n\n\n\n\t/**\n\t * Trigger recalculate threshold values when resizing.\n\t */\n\tvar resetStickyLimitsOnResize = function() {\n\t\t// Iterate managers\n\t\tfor ( var i = 0; i < _publicMethods.managers.length; i++ ) {\n\t\t\tvar manager = _publicMethods.managers[i];\n\t\t\tif ( manager ) {\n\t\t\t\t_publicMethods.resetStickyLimits( manager );\n\t\t\t}\n\t\t}\n\t};\n\n\n\n\t/**\n\t * Recalculate threshold values.\n\t */\n\t_publicMethods.resetStickyLimits = function( manager ) {\n\t\tvar windowHeight = Math.max( document.documentElement.clientHeight, window.innerHeight || 0 );\n\t\tvar thresholdAttrValue = manager.stickyElement.getAttribute( manager.settings.thresholdAttribute );\n\t\tvar elementRect = manager.stickyElement.getBoundingClientRect();\n\t\tvar elementOffset = getOffsetTop( manager.stickyElement );\n\n\t\t// Threshold\n\t\tmanager.settings.threshold = isNaN( parseInt( thresholdAttrValue ) ) ? elementOffset : parseInt( thresholdAttrValue );\n\n\t\t// Calculate threshold for elements sticky to the bottom\n\t\tif ( manager.settings.position == 'bottom' ) {\n\t\t\tmanager.settings.threshold = Math.max( manager.settings.threshold - windowHeight + elementRect.height, 0 );\n\t\t}\n\n\t\t// Maybe get relativeElement set via attribute\n\t\tvar relativeElementAttribute = manager.stickyElement.getAttribute( manager.settings.stickyRelativeToAttribute );\n\t\tif ( relativeElementAttribute != null && relativeElementAttribute != '' ) {\n\t\t\t// Get relative sticky elements in the page\n\t\t\tmanager.relativeElement = getRelativeElement( relativeElementAttribute );\n\t\t}\n\n\t\t// Use the parent element as the container element\n\t\tmanager.containerElement = manager.stickyElement.parentNode;\n\n\t\t// Maybe get containerElement set via attribute\n\t\tvar containerSelector = manager.stickyElement.getAttribute( manager.settings.containerAttribute );\n\t\tif ( containerSelector != null && containerSelector != '' ) {\n\n\t\t\t// Try to find the containerElement in the element's hierarchy first\n\t\t\tmanager.containerElement = manager.stickyElement.closest( containerSelector );\n\n\t\t\t// Try to find the containerElement on the entire document and set to the first found element that matches the selector\n\t\t\tif ( ! manager.containerElement ) {\n\t\t\t\tmanager.containerElement = document.querySelector( containerSelector );\n\t\t\t}\n\t\t}\n\n\t\t// Maybe set endThreshold\n\t\tif ( manager.containerElement ) {\n\t\t\tvar containerHeight = parseInt( window.getComputedStyle( manager.containerElement ).height.replace( 'px' ) );\n\t\t\tvar elementHeight = parseInt( window.getComputedStyle( manager.stickyElement ).height.replace( 'px' ) );\n\t\t\tvar elementOffsetToContainer = getOffsetTop( manager.stickyElement ) - getOffsetTop( manager.containerElement );\n\n\t\t\t// Set endThreshold to bottom of containerElement\n\t\t\tmanager.settings.endThreshold = manager.settings.threshold + containerHeight - elementHeight - elementOffsetToContainer;\n\n\t\t\t// Maybe calculate endThreshold for elements sticky to the bottom\n\t\t\tif ( manager.settings.position == 'bottom' ) {\n\t\t\t\tvar endThreshold = getOffsetTop( manager.stickyElement ) - windowHeight + elementRect.height;\n\n\t\t\t\t// Maybe set endThreshold to stop sticky state at the element's normal position\n\t\t\t\tif ( endThreshold > manager.settings.threshold ) {\n\t\t\t\t\tmanager.settings.endThreshold = endThreshold;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\n\n\t/**\n\t * Get manager instance from an element.\n\t *\n\t * @param    HTMLElement   An element that is a `stickyElement`, `stickyInner` or `containerElement`.\n\t */\n\t_publicMethods.getInstance = function ( element ) {\n\t\tvar instance;\n\t\t// Try getting instance from the element\n\t\tfor ( var i = 0; i < _publicMethods.managers.length; i++ ) {\n\t\t\tvar manager = _publicMethods.managers[i];\n\t\t\tif ( manager.stickyElement == element ) { instance = manager; break; }\n\t\t}\n\n\t\t// Try getting instace from other types of elements\n\t\tif ( ! instance )  { instance = _publicMethods.getInstanceFromInner( element ); }\n\n\t\treturn instance;\n\t}\n\n\t/**\n\t * Get manager instance for innerElement.\n\t */\n\t_publicMethods.getInstanceFromInner = function ( innerElement ) {\n\t\tvar instance;\n\t\tfor ( var i = 0; i < _publicMethods.managers.length; i++ ) {\n\t\t\tvar manager = _publicMethods.managers[i];\n\t\t\tif ( manager.innerElement == innerElement ) { instance = manager; break; }\n\t\t}\n\t\treturn instance;\n\t}\n\n\n\n\t/**\n\t * Initialize an sticky element.\n\t */\n\t_publicMethods.initializeElement = function( stickyElement ) {\n\t\tvar manager = {};\n\t\tmanager.settings = extend( _settings );\n\n\t\t// Get elements\n\t\tmanager.stickyElement = stickyElement;\n\t\tmanager.innerElement = manager.stickyElement.querySelector( manager.settings.innerElementSelector );\n\n\t\tvar positionAttrValue = manager.stickyElement.getAttribute( manager.settings.positionAttribute );\n\t\tmanager.settings.position = positionAttrValue == 'top' || positionAttrValue == 'bottom' ? positionAttrValue : _settings.position;\n\n\t\t// Calculate threshold values, recalculate when resize window\n\t\t_publicMethods.resetStickyLimits( manager );\n\n\t\t// Start observing resize of relevant elements\n\t\tif ( _resizeObserver ) {\n\t\t\t_resizeObserver.observe( manager.containerElement );\n\t\t\t_resizeObserver.observe( manager.stickyElement );\n\t\t\t_resizeObserver.observe( manager.innerElement );\n\t\t}\n\n\t\t// Set element as activated\n\t\tmanager.isActivated = true;\n\t\tmanager.stickyElement.classList.add( manager.settings.isActivatedClass );\n\n\t\t// Add manager to public methods\n\t\t_publicMethods.managers.push( manager );\n\t}\n\n\n\n\t/**\n\t * Initialize.\n\t */\n\t_publicMethods.init = function( options ) {\n\t\tif ( _hasInitialized ) return;\n\n\t\t// Merge with general settings with options\n\t\t_settings = extend( _defaults, options );\n\n\t\t// Initialize resize observer\n\t\tif ( window.ResizeObserver ) {\n\t\t\t_resizeObserver = new ResizeObserver( _debounce( resetStickyLimitsOnResize, _settings.refreshRate ) );\n\t\t}\n\n\t\t// Initialize each sticky element\n\t\tvar stickyElements = document.querySelectorAll( _settings.elementSelector );\n\t\tfor ( var i = 0; i < stickyElements.length; i++ ) {\n\t\t\t_publicMethods.initializeElement( stickyElements[ i ] );\n\t\t}\n\n\t\t// Start handling sticky states\n\t\tthrottledChangeState = _throttle( maybeChangeState, _settings.refreshRate );\n\t\trequestAnimationFrame( loop );\n\n\t\t_hasInitialized = true;\n\t};\n\n\n\n\t//\n\t// Public APIs\n\t//\n\treturn _publicMethods;\n\n});\n"],"names":["root","factory","define","amd","exports","module","StickyStates","global","this","window","getOffsetTop","element","stopElement","offsetTop","offsetParent","_resizeObserver","_hasInitialized","_publicMethods","managers","_settings","_defaults","elementSelector","innerElementSelector","isEndPositionClass","isStickyClass","isStickyTopClass","isStickyBottomClass","isActivatedClass","positionAttribute","thresholdAttribute","stickyRelativeToAttribute","staticAtEndAttribute","containerAttribute","position","threshold","refreshRate","extend","extended","deep","i","Object","prototype","toString","call","arguments","length","obj","prop","hasOwnProperty","merge","isStickyPosition","matches","elementComputedPosition","getComputedStyle","getRelativeElement","selectorOrJson","relativeElement","windowWidth","innerWidth","string","JSON","parse","e","_isJSON","breakpointSelectors","entries","values","breakpointInitial","breakpointFinal","document","querySelector","selector","maybeChangeState","currentScrollPosition","pageYOffset","body","scrollTop","manager","containerStyles","containerElement","stickyStyles","stickyElement","containerHeight","parseInt","height","replace","stickyHeight","isStickyShorterThanContainer","isSticky","settings","relativeHeight","isEndThreshold","endThreshold","isStaticAtEnd","hasAttribute","offsetWidth","offsetHeight","getClientRects","getBoundingClientRect","stickyInnerWidth","innerElement","width","style","top","classList","add","remove","elementOffsetToContainer","resetStickyLimitsOnResize","resetStickyLimits","throttledChangeState","loop","requestAnimationFrame","windowHeight","Math","max","documentElement","clientHeight","innerHeight","thresholdAttrValue","getAttribute","elementRect","elementOffset","isNaN","relativeElementAttribute","parentNode","containerSelector","closest","elementHeight","getInstance","instance","getInstanceFromInner","initializeElement","positionAttrValue","observe","isActivated","push","init","options","func","wait","immediate","timeout","ResizeObserver","context","args","callNow","clearTimeout","setTimeout","apply","fn","threshhold","scope","last","deferTimer","stickyElements","querySelectorAll","now","Date"],"mappings":"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"}